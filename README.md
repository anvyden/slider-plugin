# MetaLamp 4 task - Slider for jQuery

[Демо страница](https://anvyden.github.io/slider-plugin/) для тестирования возможностей слайдера.

## Содержание

- [`Возможности`](#возможности)

### Возможности

 - Два типа слайдера (одиночный и диапазон)
 - Поддержка отрицательных значений
 - Любое количество слайдеров на странице
 - Поддержка тач-устройств
 - Поддержка с клавиатуры
 - Адаптируется под изменения ширины/высоты контейнера
 - Кастомизация:
   - Задание размера шага
   - Возможность задать диапазон значений
   - Горизонтальный или вертикальный вид
   - Возможность вкл/откл прогресс-бар
   - Возможность вкл/откл подписи под шкалой значений
   - Возможность задать количество подписей под шкалой значений
   - Возможность вкл/откл подписи над ползунками

## Архитектура

Данный плагин выполнен по `MVP-архитектуре` с Passive View. Благодаря этому, бизнес-логика слайдера отделена от его отображения. Для осуществления такой архитектуры используется паттерн `Observer`, который позволяет взаимодействовать модулям между собой, ничего не зная друг о друге.

### Model

**Model** - модуль, отвечающий за бизнес-логику всего приложения. Он хранит все состояния приложения и осуществляет валидацию данных. Имеет методы для чтения и записи (всего состояния приложения или каждого параметра по отдельности), и методы для обработки значений слайдера, как в численном значении, так и в процентном, полученных от `View`, для обновления состояния приложения. 

### View

**View** - модуль, отвечающий за отображение слайдера, обновление его внешнего вида и взаимодействие пользователя с ним.
Основной модуль `View` декомпозирован на более мелкие компоненты `subView`. С помощью абстрактного класса `Observer`, некоторые компоненты подписываются на события изменения состояния приложения. Это позволяет `subView` быть низкоуровневыми компонентами, ничего незнающими о более высоком уровне, но при этом всегда иметь доступ к актуальному состоянию и производить обновление своего отображения.

Все `subView` обладают схожим интерфейсом: каждый компонент создает свой элемент, добавляет слушателей и сообщает о своих изменениях другим, подписанным, компонентам. Также может обновлять свои отдельные части без полной перерисовки.

Для инициализации/перерисовки графической части используется класс `Slider`, в котором инициализируются и хранятся все компоненты `subView`, что позволяет `view` легко взаимодействовать с `subView` с помощью паттерна `Observer`.

Класс `View` умеет прослушивать события `subView`, а также имеет несколько методов:
 - методы `checkTooltipsOverlap()` и `createUnitedTooltip()` проверяет перекрытие между подписями над ползунками и создает одну общую подпись.
 - метод `setThumbZIndex()` меняет свойство `z-index` у ползунков в зависимости от того, какой в данный момент является активным.
 - метод `setTargetThumb()` передает `target` при клике по шкале, позволяя сразу передвигать ползунок.

### Presenter
**Presenter** - модуль, который имеет зависимости от других модулей приложения.

`Presenter` выполняет несколько функций:
+ Создает `model` и `view`
+ Подписывается на изменения `model` и `view`
+ Реагирует на обновление `model` и обновляет `view`
+ Реагирует на обновление `view` и обновляет `model`
+ Создает кастомное событие `update`, которое позволяет получать актуальное состояние приложения и осуществлять логику при изменении состояния слайдера.

Передача данных снизу вверх осуществляется следующим образом: `subView` -> `View` -> `Presenter` -> `Model`

## Развертывание

### Клонирование репозитория

```bash
  git clone https://github.com/anvyden/slider-plugin.git
```

### Команды

| Установка зависимостей |  Разработка   | Production сборка | Тестирование |    Покрытие тестами     |
|:----------------------:|:-------------:|:-----------------:|:------------:|:-----------------------:|
|     `npm isntall`      | `npm run dev` |  `npm run build`  |  `npm test`  | `npm run test:coverage` |

## Подключение слайдера и использование

1. Для работы плагина необходимо подключить `JQuery-3.x`
2. Для подключения плагина необходимо взять из папок `./dist/assets/js` и `./dist/assets/css` файлы:
  - `plugin.js`
  - `plugin.css`

*Пример подключения:*
```html
<html>
  <head>
     ...
     <!--JQuery-->
     <script defer='defer' src='https://code.jquery.com/jquery-3.6.0.min.js'></script>
     <!--JavaScript file-->
     <script defer='defer' src='plugin.js'></script>
     <!--Styles file-->
     <link href='plugin.css' rel='stylesheet' />
  </head>
</html>
```

*Инициализация с настройками по умолчанию:*
```html
   <!--HTML-->
   <body>
    ...
    <div id='root'></div>
   </body>
```
```js
   /* JavaScript */
   $('#root').sliderPlugin()
```

*С пользовательскими настройками:*
```js
   $('#root').sliderPlugin({
      max: 200,
      min: -200,
      step: 20,
      from: -100,
      to: 120,
      isRange: true,
      orientation: 'vertical',
      color: 'purple',
      hasTooltips: true,
      hasProgressBar: true,
      labels: {
         addLabels: true,
         countOfLabels: 6,
      },
   })
```

### Параметры слайдера

|      Опции       |   Тип   |  По-умолчанию  |                         Описание                         |
|:----------------:|:-------:|:--------------:|:--------------------------------------------------------:|
|      `min`       | number  |      `0`       |                Минимальное значение шкалы                |
|      `max`       | number  |     `100`      |               Максимальное значение шкалы                |
|      `step`      | number  |      `10`      |                        Шаг шкалы                         |
|      `from`      | number  |      `20`      | Значение одиночного ползунка / Начальное знач. диапазона | 
|       `to`       | number  |      `50`      |               Конечное значение диапазона                |
|      -----       |  -----  |     -----      |                          -----                           |
|  `orientation`   | string  | `'horizontal'` |        Ориентация слайдера (horizontal/vertical)         |
|     `color`      | string  |   `'orange'`   |               Цвет слайдера (purple/green)               |
|    `isRange`     | boolean |     `true`     |            Тип слайдера (одиночный/диапазон)             |
| `hasProgressBar` | boolean |     `true`     |       Заливка (от min до from либо от from до to)        |
|  `hasTooltips`   | boolean |     `true`     |       Отображение текущего значения над ползунком        |
|   `addLabels`    | boolean |     `true`     |                  Подписи шкалы значений                  |
| `countOfLabels`  | number  |      `6`       |            Количество подписей шкалы значений            |
